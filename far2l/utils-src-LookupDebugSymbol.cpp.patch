diff --git a/utils/src/LookupDebugSymbol.cpp b/utils/src/LookupDebugSymbol.cpp
index e06bf05..4ac51d3 100644
--- a/utils/src/LookupDebugSymbol.cpp
+++ b/utils/src/LookupDebugSymbol.cpp
@@ -9,17 +9,29 @@
 # include "ScopeHelpers.h"
 
 # if defined(__LP64__) || defined(_LP64)
-	typedef Elf64_Ehdr Elf_Ehdr;
-	typedef Elf64_Phdr Elf_Phdr;
-	typedef Elf64_Shdr Elf_Shdr;
-	typedef Elf64_Sym  Elf_Sym;
-#  define ELF_ST_TYPE(INFO) ELF64_ST_TYPE(INFO)
+  typedef Elf64_Ehdr Elf_Ehdr;
+  typedef Elf64_Phdr Elf_Phdr;
+  typedef Elf64_Shdr Elf_Shdr;
+  typedef Elf64_Sym  Elf_Sym;
+#  ifndef ELF_ST_TYPE
+#    if defined(ELF64_ST_TYPE)
+#      define ELF_ST_TYPE(INFO) ELF64_ST_TYPE(INFO)
+#    else
+#      define ELF_ST_TYPE(INFO) ((unsigned)((unsigned char)(INFO) & 0xf))
+#    endif
+#  endif
 # else
-	typedef Elf32_Ehdr Elf_Ehdr;
-	typedef Elf32_Phdr Elf_Phdr;
-	typedef Elf32_Shdr Elf_Shdr;
-	typedef Elf32_Sym  Elf_Sym;
-#  define ELF_ST_TYPE(INFO) ELF32_ST_TYPE(INFO)
+  typedef Elf32_Ehdr Elf_Ehdr;
+  typedef Elf32_Phdr Elf_Phdr;
+  typedef Elf32_Shdr Elf_Shdr;
+  typedef Elf32_Sym  Elf_Sym;
+#  ifndef ELF_ST_TYPE
+#    if defined(ELF32_ST_TYPE)
+#      define ELF_ST_TYPE(INFO) ELF32_ST_TYPE(INFO)
+#    else
+#      define ELF_ST_TYPE(INFO) ((unsigned)((unsigned char)(INFO) & 0xf))
+#    endif
+#  endif
 # endif
 
 static FDScope s_initial_cwdfd(open(".", O_PATH));
